# =============================================================================
# Curriculum Template CMS Configuration
# =============================================================================
# This is a TEMPLATE file. The actual config.yml is generated at build time
# from environment variables. See docs/cms-setup.md for setup instructions.
#
# Required environment variables (set in Netlify):
#   CMS_REPO     - Your GitHub username/repo (e.g., "username/repo-name")
#   CMS_AUTH_URL - Your Cloudflare Worker URL (e.g., "https://my-auth.workers.dev")
#
# Schema Version: 2.0 (Single Language)
# =============================================================================

backend:
  name: github
  repo: ${CMS_REPO}
  branch: main
  base_url: ${CMS_AUTH_URL}

media_folder: static/images
public_folder: /images

slug:
  encoding: ascii
  clean_accents: true
  sanitize_replacement: '-'

collections:
  # ==========================================================================
  # CLUSTERS
  # Thematic groupings of lessons. Each cluster contains multiple lessons.
  # ==========================================================================
  - name: clusters
    label: Clusters
    label_singular: Cluster
    folder: content/clusters
    create: true
    slug: '{{slug}}'
    sortable_fields: ['order', 'title']
    summary: '{{order}}. {{title}}'
    preview_path: 'curriculum/{{slug}}'
    fields:
      - label: Title
        name: title
        widget: string
        hint: "The name of this cluster (e.g., 'Getting Started', 'Core Concepts')"
      - label: Slug
        name: slug
        widget: string
        hint: "URL-friendly version (e.g., 'getting-started'). Use lowercase, hyphens only."
      - label: Order
        name: order
        widget: number
        value_type: int
        min: 1
        hint: "Display order (1 = first cluster shown)"
      - label: Description
        name: description
        widget: text
        hint: "Brief description shown on curriculum overview (1-2 sentences)"
      - label: Overview
        name: body
        widget: markdown
        required: false
        hint: "Optional longer introduction shown on cluster page"

  # ==========================================================================
  # LESSONS
  # Individual lessons within clusters. Each lesson typically covers one reading.
  # ==========================================================================
  - name: lessons
    label: Lessons
    label_singular: Lesson
    folder: content/lessons
    create: true
    slug: '{{cluster}}-{{slug}}'
    sortable_fields: ['order', 'title', 'cluster']
    summary: '{{cluster}} / {{order}}. {{title}}'
    preview_path: 'curriculum/{{cluster}}/{{slug}}'
    fields:
      - label: Title
        name: title
        widget: string
        hint: "The title of the reading or lesson"
      - label: Slug
        name: slug
        widget: string
        hint: "URL-friendly version. Use lowercase, hyphens only."
      - label: Cluster
        name: cluster
        widget: relation
        collection: clusters
        value_field: slug
        search_fields: ['title', 'slug']
        display_fields: ['title']
        hint: "Which cluster this lesson belongs to"
      - label: Author
        name: author
        widget: string
        required: false
        hint: "Author of the primary reading (if applicable)"
      - label: Order
        name: order
        widget: number
        value_type: int
        min: 1
        hint: "Order within the cluster (1 = first lesson)"
      - label: Description
        name: description
        widget: text
        hint: "Brief description shown in lesson lists (1-2 sentences)"
      - label: Featured Image
        name: featured_image
        widget: image
        required: false
        hint: "Optional image shown at top of lesson"
      - label: Learning Objectives
        name: objectives
        widget: list
        required: false
        field: { label: Objective, name: objective, widget: string }
        hint: "What will the reader learn? (bullet points)"
      - label: Key Concepts
        name: key_concepts
        widget: list
        required: false
        fields:
          - { label: Concept Name, name: name, widget: string }
          - { label: Explanation, name: explanation, widget: markdown }
        hint: "Core ideas explained in detail"
      - label: Assignment
        name: assignment
        widget: object
        required: false
        fields:
          - { label: Instructions, name: instructions, widget: markdown }
          - { label: Reading URL, name: url, widget: string, required: false }
          - { label: Reading Title, name: reading_title, widget: string, required: false }
        hint: "The primary reading assignment with link"
      - label: Knowledge Check
        name: knowledge_check
        widget: list
        required: false
        fields:
          - { label: Question, name: question, widget: string }
          - { label: Hint, name: hint, widget: text, required: false }
        hint: "Reflection questions for the reader"
      - label: Additional Resources
        name: additional_resources
        widget: list
        required: false
        fields:
          - { label: Title, name: title, widget: string }
          - { label: Author, name: author, widget: string, required: false }
          - { label: URL, name: url, widget: string, required: false }
          - { label: Description, name: description, widget: text }
        hint: "Related readings for deeper exploration"
      - label: Introduction
        name: body
        widget: markdown
        required: false
        hint: "Main content introducing the reading and its significance"

  # ==========================================================================
  # PAGES
  # Static pages like About
  # ==========================================================================
  - name: pages
    label: Pages
    files:
      - name: about
        label: About Page
        file: content/pages/about.md
        fields:
          - { label: Title, name: title, widget: string }
          - { label: Subtitle, name: subtitle, widget: string }
          - { label: Content, name: body, widget: markdown }
      - name: home
        label: Home Page
        file: content/pages/home.md
        fields:
          - label: Title
            name: title
            widget: string
            hint: "Main curriculum title (displayed in book cover)"
          - label: Tagline
            name: tagline
            widget: text
            hint: "One-sentence value proposition"
          - label: CTA Button Text
            name: cta_text
            widget: string
            default: "Begin Reading"
            hint: "Call-to-action button text"
          - label: Approach Section
            name: body
            widget: markdown
            required: false
            hint: "Optional philosophy/methodology section below clusters"

  # ==========================================================================
  # SETTINGS
  # Site-wide configuration
  # ==========================================================================
  - name: settings
    label: Settings
    files:
      - name: site
        label: Site Settings
        file: content/settings/site.json
        fields:
          - label: Site Title
            name: title
            widget: string
            hint: "Shown in browser tab and SEO"
          - label: Site Description
            name: description
            widget: text
            hint: "SEO description (1-2 sentences)"
          - label: Author Name
            name: author
            widget: string
            hint: "Your name or organization"
          - label: Author URL
            name: substack_url
            widget: string
            required: false
            hint: "Link to your website, Substack, etc."
          - label: Footer Text
            name: footer_text
            widget: string
            hint: "Tagline shown in footer"
